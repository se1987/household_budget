# 家計簿アプリ API 設計書

## 概要

本設計書は、Next.js の Express を使用した家計簿アプリの API 仕様を定義します。このAPIは、REST アーキテクチャを基盤とし、家計簿アプリのデータ操作を行います。

### 1. リソース一覧

| リソース     | 説明                   |
| ------------ | ---------------------- |
| categories   | 費目に関する情報       |
| transactions | 収入・支出に関する情報 |

### 2. エンドポイント一覧

| エンドポイント      | 説明                   |
| ------------------- | ---------------------- |
| `/api/categories`   | 費目に関する情報       |
| `/api/transactions` | 収入・支出に関する情報 |

### 3. HTTP メソッドごとの設計内容

| リソース                | POST                 | GET                          | PUT                                   | DELETE                                |
| ----------------------- | -------------------- | ---------------------------- | ------------------------------------- | ------------------------------------- |
| `/api/transactions`     | 新規収入・支出を作成 | すべての収入・支出情報を取得 | すべての収入・支出を更新 (実装しない) | すべての収入・支出を削除 (実装しない) |
| `/api/transactions/:id` | (実装しない)         | 特定の収入・支出情報を取得   | 特定の収入・支出を更新                | 特定の収入・支出を削除                |
| `/api/categories`       | 新規費目を作成       | すべての費目情報を取得       | すべての費目を更新 (実装しない)       | すべての費目を削除 (実装しない)       |
| `/api/categories/:id`   | (実装しない)         | 特定の費目情報を取得         | 特定の費目を更新                      | 特定の費目を削除                      |

### 4. リクエスト・レスポンス データ形式

リクエスト・レスポンスともにJSONファイル形式（以下具体例）

#### 4.1 POST, PUT リクエストデータ型　(Transaction)

```json
{
  "amount": 500,
  "type": "支出",
  "date": "2024-07-26T00:00:00.000Z",
  "category": {
    "name": "食費"
  },
  "description": "ランチ"
}
```

#### 4.2 GET リクエストに対するレスポンスデータ型　 (TransactionResponse)

```json
{
  "id": 2,
  "amount": 500,
  "date": "2024-07-26T00:00:00.000Z",
  "type": "支出",
  "categoryId": 1,
  "description": "ランチ",
  "category": "食費"
}
```

#### 4.3 POST, PUT リクエストデータ型 (Category)

```json
{
  "id": 1,
  "name": "給与"
}
```

#### 4.4 GET リクエストに対するレスポンスデータ型 (CategoryResponse)

```json
{
  "id": 1,
  "name": "給与"
}
```

### 5. エラー処理の内容

| エラーコード | エラーメッセージ         | 説明                               |
| ------------ | ------------------------ | ---------------------------------- |
| 400          | バッドリクエスト         | リクエストデータが不正な場合       |
| 404          | リソースが見つかりません | 指定されたリソースが存在しない場合 |
| 500          | サーバーエラー           | サーバー側のエラーが発生した場合   |

### 6. API 設計に関する詳細

## /api/transactions エンドポイント

| HTTP メソッド | 説明                         | リクエストデータ形式 | レスポンスデータ形式    |
| ------------- | ---------------------------- | -------------------- | ----------------------- |
| GET           | すべての収入・支出情報を取得 | なし                 | `TransactionResponse[]` |
| POST          | 新規収入・支出を作成         | `Transaction`        | `TransactionResponse`   |

## /api/transactions/:id エンドポイント

| HTTP メソッド | 説明                       | リクエストパラメータ  | リクエストデータ形式 | レスポンスデータ形式  |
| ------------- | -------------------------- | --------------------- | -------------------- | --------------------- |
| GET           | 特定の収入・支出情報を取得 | `id` (収入・支出のID) | なし                 | `TransactionResponse` |
| PUT           | 特定の収入・支出を更新     | `id` (収入・支出のID) | `Transaction`        | `TransactionResponse` |
| DELETE        | 特定の収入・支出を削除     | `id` (収入・支出のID) | なし                 | 204 No Content        |

### /api/categories エンドポイント

| HTTP メソッド | 説明                   | リクエストデータ形式 | レスポンスデータ形式 |
| ------------- | ---------------------- | -------------------- | -------------------- |
| GET           | すべての費目情報を取得 | なし                 | `CategoryResponse[]` |
| POST          | 新規費目を作成         | `name` (費目名)      | `CategoryResponse`   |

### /api/categories/:id エンドポイント

| HTTP メソッド | 説明                      | リクエストパラメータ | リクエストデータ形式 | レスポンスデータ形式 |
| ------------- | ------------------------- | -------------------- | -------------------- | -------------------- |
| PUT           | 特定の費目を更新 (未実装) | `id` (費目のID)      | `Category`           | `CategoryResponse`   |
| DELETE        | 特定の費目を削除 (未実装) | `id` (費目のID)      | なし                 | 204 No Content       |

### 7. その他

- すべてのエンドポイントはJSON形式でレスポンスを返す
- エラーが発生した場合、エラーコードとエラーメッセージを含むJSON形式でレスポンスを返す
- APIドキュメントを整備し、開発者が利用しやすいようにする
